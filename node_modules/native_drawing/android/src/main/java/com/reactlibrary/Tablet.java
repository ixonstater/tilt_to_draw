package com.reactlibrary;

import android.view.SurfaceView;
import android.view.SurfaceHolder;
import android.util.DisplayMetrics;
import android.graphics.Canvas;
import android.graphics.Paint;
import android.graphics.Color;
import android.content.Context;
import android.content.pm.ActivityInfo;
import android.app.Activity;
import android.content.ContextWrapper;
import react.debuglogmanager.Logger;
import com.reactlibrary.SimpleFloatVector;

public class Tablet extends SurfaceView{
  private SurfaceHolder holder;
  private Paint paint;
  private SimpleFloatVector pts;
  private Context ctx;

  public Tablet(Context context){
    super(context);
    this.ctx = context;
    this.paint = new Paint(Paint.ANTI_ALIAS_FLAG);
    this.paint.setColor(Color.RED);
    this.paint.setStrokeWidth(20);
    this.holder = getHolder();
    this.pts = new SimpleFloatVector(8000);
  }

  public void draw(float x, float y){
    Canvas canvas = this.holder.lockCanvas();
    if(canvas != null){
      this.pts.add(x);
      this.pts.add(y);
      canvas.drawLines(this.pts.getArr(), this.paint);
      holder.unlockCanvasAndPost(canvas);
      this.pts.add(x);
      this.pts.add(y);
    }
  }

  public void getStartingCoords(float x, float y){
    this.pts.add(x);
    this.pts.add(y);
  }

  @Override
  protected void onAttachedToWindow(){
    super.onAttachedToWindow();
    Activity tempRef = (Activity)(((ContextWrapper)this.ctx).getBaseContext());
    tempRef.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
    this.setSystemUiVisibility(this.SYSTEM_UI_FLAG_IMMERSIVE | this.SYSTEM_UI_FLAG_HIDE_NAVIGATION | this.SYSTEM_UI_FLAG_FULLSCREEN);
  }

  @Override
  protected void onDetachedFromWindow(){
    super.onDetachedFromWindow();
    Activity tempRef = (Activity)(((ContextWrapper)this.ctx).getBaseContext());
    tempRef.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_SENSOR);
  }
}